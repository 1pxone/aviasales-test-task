(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(e,t,n){},29:function(e,t,n){e.exports=n(61)},57:function(e,t,n){},59:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(24),i=n.n(c),s=n(4),u=n(5),o=n(8),l=n(6),p=n(9),h=n(7),d=n(11),f=n.n(d),m="http://hlebbobulka.github.io/aviasales-test-task/data/tickets.json",E="https://www.cbr-xml-daily.ru/daily_json.js",_="TICKETS_IS_LOADING",y="TICKETS_GET_SUCCESS",k="TICKETS_HAS_ERRORED",b="TICKETS_ERRORS",v="TICKETS_FILTERS",g="CURRENCY_IS_LOADING",C="CURRENCY_GET_SUCCESS",O="CURRENCY_HAS_ERRORED",T="CURRENCY_ERRORS",N="CURRENCY_CHANGE";function j(e){return{type:_,isLoading:e}}function R(e){return{type:k,hasErrored:e}}function I(e){return{type:b,ticketsErrors:e}}function S(){return function(e){e(R(!1)),e(I([])),e(j(!0)),f.a.get(m).then(function(t){var n;e((n=t.data.tickets,{type:y,allTickets:n,tickets:n})),e(j(!1))}).catch(function(t){console.log(t),e(j(!1)),e(R(!0)),e(I(t))})}}function w(e){return{type:g,isLoading:e}}function D(e){return{type:O,hasErrored:e}}function U(e){return{type:T,currencyErrors:e}}function x(){return function(e){e(D(!1)),e(U([])),e(w(!0)),f.a.get(E).then(function(t){var n;e((n=t.data,{type:C,currencyData:n})),e(w(!1))}).catch(function(t){console.log(t),e(w(!1)),e(D(!0)),e(U(t))})}}var L=n(15),F=(n(23),function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"as-input__wrapper as-input__label as-input__label--checkbox noselect",onClick:function(t){return e.props.onChange(t,e.props.value)}},a.a.createElement("input",{className:"as-input as-input--checkbox",type:"checkbox",onChange:this.props.onChange,name:this.props.name,value:this.props.value,checked:this.props.defaultChecked}),a.a.createElement("span",{className:"as-input__checkmark"}),a.a.createElement("span",{className:"as-input__checkboxLabel"},this.props.label,this.props.onlyThis?a.a.createElement("span",{className:"as-input__onlyThis",onClick:function(t){return e.props.onlyThis(t,e.props.value)}},"\u0422\u041e\u041b\u042c\u041a\u041e"):null))}}]),t}(r.Component)),A=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement("label",{className:"as-input__wrapper as-input__label as-input__label--radio noselect"+(this.props.defaultChecked?" as-input__label--checked":" as-input__label--unchecked")},a.a.createElement("input",{className:"as-input as-input--radio",type:"radio",onChange:this.props.onChange,name:this.props.name,value:this.props.value,checked:this.props.defaultChecked}),a.a.createElement("span",{className:"as-input__radioLabel"},this.props.label))}}]),t}(r.Component),B=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(o.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).onChangeChekboxes=function(e,t){var r=Object(L.a)(n.props.filters);if(r.find(function(e){return e===t})){var a=r.findIndex(function(e){return e===t});if(r.splice(a,1),!r.find(function(e){return"0"===e})||!r.find(function(e){return"1"===e})||!r.find(function(e){return"2"===e})||!r.find(function(e){return"3"===e})){var c=r.findIndex(function(e){return"all"===e});c>=0&&r.splice(c,1)}r.length||(r=["all","0","1","2","3"])}else{r.push(t),r.find(function(e){return"0"===e})&&r.find(function(e){return"1"===e})&&r.find(function(e){return"2"===e})&&r.find(function(e){return"3"===e})&&(r=["all","0","1","2","3"])}n.props.ticketsFilters(r)},n.onChangeAll=function(){Object(L.a)(n.props.filters).findIndex(function(e){return"all"===e})>=0||n.props.ticketsFilters(["all","0","1","2","3"])},n.onlyThis=function(e,t){e.stopPropagation(),n.props.ticketsFilters([t])},n.onCurrencyChange=function(e){n.props.changeCurrency(e.target.value)},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"Filters__wrapper"},a.a.createElement("div",{className:"CurrencyToggle__wrapper"},a.a.createElement("span",{className:"Filters__subtitle"},"\u0412\u0410\u041b\u042e\u0422\u0410"),a.a.createElement("div",{className:"CurrencyToggle__buttons"},a.a.createElement(A,{onChange:this.onCurrencyChange,name:"currency",value:"RUB",label:"RUB",defaultChecked:"RUB"===this.props.currency}),a.a.createElement(A,{onChange:this.onCurrencyChange,name:"currency",value:"USD",label:"USD",defaultChecked:"USD"===this.props.currency}),a.a.createElement(A,{onChange:this.onCurrencyChange,name:"currency",value:"EUR",label:"EUR",defaultChecked:"EUR"===this.props.currency}))),a.a.createElement("div",{className:"StopsFilter__wrapper"},a.a.createElement("span",{className:"Filters__subtitle"},"\u041a\u041e\u041b\u0418\u0415\u0421\u0422\u0412\u041e \u041f\u0415\u0420\u0415\u0421\u0410\u0414\u041e\u041a"),a.a.createElement(F,{onChange:this.onChangeAll,label:"\u0412\u0441\u0435",name:"",value:"all",defaultChecked:this.props.filters.findIndex(function(e){return"all"===e})>=0}),a.a.createElement(F,{onChange:this.onChangeChekboxes,label:"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a",name:"",value:"0",defaultChecked:this.props.filters.findIndex(function(e){return"0"===e})>=0,onlyThis:this.onlyThis}),a.a.createElement(F,{onChange:this.onChangeChekboxes,label:"1 \u041f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430",name:"",value:"1",defaultChecked:this.props.filters.findIndex(function(e){return"1"===e})>=0,onlyThis:this.onlyThis}),a.a.createElement(F,{onChange:this.onChangeChekboxes,label:"2 \u041f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",name:"",value:"2",defaultChecked:this.props.filters.findIndex(function(e){return"2"===e})>=0,onlyThis:this.onlyThis}),a.a.createElement(F,{onChange:this.onChangeChekboxes,label:"3 \u041f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",name:"",value:"3",defaultChecked:this.props.filters.findIndex(function(e){return"3"===e})>=0,onlyThis:this.onlyThis})))}}]),t}(r.Component),H=Object(h.b)(function(e){return{filters:e.tickets.filters}},function(e){return{changeCurrency:function(t){return e({type:N,currency:t})},ticketsFilters:function(t){return e({type:v,filters:t})}}})(B);n(57);function Y(e){var t=e.split("."),n=new Date(t[1]+"."+t[0]+"."+t[2]),r=n.getMonth(),a=n.getDate(),c=n.getFullYear(),i=n.getDay();return a+" "+["\u042f\u043d\u0432","\u0424\u0435\u0432","\u041c\u0430\u0440","\u0410\u043f\u0440","\u041c\u0430\u044f","\u0418\u044e\u043d","\u0418\u044e\u043b","\u0410\u0432\u0433","\u0421\u0435\u043d","\u041e\u043a\u0442","\u041d\u043e\u044f","\u0414\u0435\u043a"][r]+" "+c+", "+["\u0412\u0441","\u041f\u043d","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041f\u0442","\u0421\u0431"][i]}function G(e){return e.toFixed(0).replace(/./g,function(e,t,n){return t>0&&"."!==e&&(n.length-t)%3===0?" "+e:e})}var K=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(o.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).currencyConverter=function(e){var t=n.props.currencyData.Valute;switch(n.props.currency){case"USD":return G(parseInt(e/t.USD.Value))+" $";case"EUR":return G(parseInt(e/t.EUR.Value))+" \u20ac";default:return G(e)+" \u20bd"}},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.ticket;return a.a.createElement("div",{className:"Ticket"},a.a.createElement("div",{className:"Ticket__buyBlock"},a.a.createElement("img",{src:"/img/carriers/".concat(e.carrier,".png"),className:"Ticket__carrier",alt:e.carrier}),a.a.createElement("button",{type:"button",className:"Ticket__buyButton"},"\u041a\u0443\u043f\u0438\u0442\u044c ",a.a.createElement("br",null)," \u0437\u0430 ",this.currencyConverter(e.price))),a.a.createElement("div",{className:"Ticket__infoBlock"},a.a.createElement("div",{className:"Ticket__times"},a.a.createElement("div",{className:"Ticket__origin"},a.a.createElement("span",{className:"Ticket__dt"},e.departure_time)),a.a.createElement("div",{className:"Ticket__stops"},function(e){switch(e){case 0:return"";default:return e+" "+function(e){var t=["\u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430","\u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438","\u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"],n=e%100;return n>=5&&n<=20?t[2]:1===(n%=10)?t[0]:n>=2&&n<=4?t[1]:t[2]}(e)}}(e.stops),a.a.createElement("div",{className:"Ticket__stopsWrap"},a.a.createElement("div",{className:"Ticket__stopsLine"}),a.a.createElement("img",{src:"/img/plane.svg",alt:e.carrier}))),a.a.createElement("div",{className:"Ticket__destination"},a.a.createElement("span",{className:"Ticket__at"},e.arrival_time))),a.a.createElement("div",{className:"Ticket__meta"},a.a.createElement("div",{className:"Ticket__origin"},a.a.createElement("span",{className:"Ticket__o"},e.origin,", ",e.origin_name),a.a.createElement("span",{className:"Ticket__dd"},Y(e.departure_date))),a.a.createElement("div",{className:"Ticket__destination"},a.a.createElement("span",{className:"Ticket__d"},e.destination_name,", ",e.destination),a.a.createElement("span",{className:"Ticket__ad"},Y(e.arrival_date))))))}}]),t}(r.Component),V=Object(h.b)(function(e){return{currency:e.currency.currency,currencyData:e.currency.currencyData}},function(e){return{}})(K),M=function(e){var t=e.tickets;return a.a.createElement("div",{className:"Tickets__wrapper"},t.sort(function(e,t){return e.price>t.price}).map(function(e,t){return a.a.createElement(V,{ticket:e,key:t})}))},J=Object(h.b)(function(e){return{tickets:function(e,t){if(t.findIndex(function(e){return"all"===e})>=0)return e;var n=[];return t.map(function(t){return n.push.apply(n,e.filter(function(e){return e.stops===parseInt(t)})),null}),n}(e.tickets.tickets,e.tickets.filters)}})(M),P=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchTicketsData(),this.props.fetchCurrencyRates()}},{key:"render",value:function(){return this.props.ticketsIsLoading||this.props.currencyIsLoading?a.a.createElement("div",{className:"container"},"loading..."):this.props.ticketsHasErrored||this.props.currencyHasErrored?a.a.createElement("div",{className:"container"},"error!"):a.a.createElement("div",{className:"container"},a.a.createElement("div",{className:"logo__wrapper"},a.a.createElement("img",{src:"/img/logo.png",alt:"logo"})),a.a.createElement("div",{className:"content__wrapper"},a.a.createElement(H,{currency:this.props.currency}),a.a.createElement(J,null)))}}]),t}(r.Component),X=Object(h.b)(function(e){return{ticketsIsLoading:e.tickets.isLoading,tickets:e.tickets.tickets,ticketsErrors:e.tickets.ticketsErrors,ticketsHasErrored:e.tickets.hasErrored,currencyData:e.currency.currencyData,currencyIsLoading:e.currency.isLoading,currency:e.currency.currency,currencyErrors:e.currency.currencyErrors,currencyHasErrored:e.currency.hasErrored}},function(e){return{fetchTicketsData:function(){return e(S())},fetchCurrencyRates:function(){return e(x())}}})(P),W=(n(59),n(10)),$=n(28),q=n(3),z={isLoading:!1,tickets:[],ticketsErrors:[],hasErrored:!1,filters:["all","0","1","2","3"]};var Q={isLoading:!1,currency:"RUB",currencyData:null,currencyErrors:[],hasErrored:!1};var Z=Object(W.c)({tickets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:var n=t.isLoading;return Object(q.a)({},e,{isLoading:n});case y:var r=t.tickets;return Object(q.a)({},e,{tickets:r});case k:var a=t.hasErrored;return Object(q.a)({},e,{hasErrored:a});case b:var c=t.ticketsErrors;return Object(q.a)({},e,{ticketsErrors:c});case v:var i=t.filters;return Object(q.a)({},e,{filters:i});default:return e}},currency:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:var n=t.isLoading;return Object(q.a)({},e,{isLoading:n});case C:var r=t.currencyData;return Object(q.a)({},e,{currencyData:r});case O:var a=t.hasErrored;return Object(q.a)({},e,{hasErrored:a});case T:var c=t.currencyErrors;return Object(q.a)({},e,{currencyErrors:c});case N:var i=t.currency;return Object(q.a)({},e,{currency:i});default:return e}}});var ee=function(e){var t=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||W.d;return Object(W.e)(Z,e,t(Object(W.a)($.a)))}();i.a.render(a.a.createElement(h.a,{store:ee},a.a.createElement(X,null)),document.getElementById("root"))}},[[29,2,1]]]);
//# sourceMappingURL=main.474ab5d0.chunk.js.map